---
title: "Initial paper draft"
# subtitle: "Subtitle here"
author:
  - |
      Christopher Prosser^[\faUniversity\ Royal Holloway, University of London\newline
      \faGlobe\ \href{https://caprosser.com/}{caprosser.com}\newline
      \faEnvelope\ \href{mailto:chris.prosser@rhul.ac.uk}{chris.prosser@rhul.ac.uk}]
abstract: "Everyone agrees that this issue is really important. But we do not know much about this specific question, although it matters a great deal, for these reasons. We approach the problem from this perspective. Our research design focuses on these cases and relies on these data, which we analyse using this method. Results show what we have learned about the question. They have these broader implications"
# Add keywords by appending this to the end of the absract
# \\newline
# \\newline
# \\textbf{Keywords:} Keyword 1; Keyword 2; Keyword 3 etc
date: "`r DescTools::Format(Sys.Date(), fmt = 'd mmmm yyyy')`"
papersize: a4
linestretch: 1 # Linespacing (multiples of the default lineskip)
geometry:
  - margin=1.6in
  # - showframe # Uncomment to add frame (useful for debugging whether stuff is overflowing the margins)
output:
   chrisdoc::pdf_chrisdoc:
    number_sections: false
    keep_tex: yes
classoption: twoside # Only really necessary if you want different headers on odd and even pages
toc: no
always_allow_html: true
header-includes:
  # Put paper type (Working paper, For peer review, Accepted version etc) here. Leave {} blank to omit
  - \renewcommand{\coverstatus}{Working paper}
  # Add extra notes for the title page here.  Leave {} blank to omit
  - \renewcommand{\TitlePageNote}{}
  # Fancy page numbering, delete or comment out to turn off
  - \def\usefancypagecount{}
  # Headers
  - \renewcommand{\MainHeaderOdd}{}
  - \renewcommand{\MainHeaderEven}{}
  - \renewcommand{\ApdxHeaderOdd}{}
  - \renewcommand{\ApdxHeaderEven}{}
  - \renewcommand{\SetHeadruleWidth}{0pt}
  # To control floats
  - \usepackage{float}
  - \floatplacement{table}{H}
  # For drawing tikz diagrams, including a custom dashed long left-right arrow
  - \usepackage{tikz, tikz-cd}\usetikzlibrary{arrows.meta}\newcommand{\longdashleftrightarrow}[1][1.75em]{\mathrel{\tikz[baseline]{\draw[dash pattern=on 0.25em off 0.1 em,<->](0,.58ex)--(#1,.58ex)}}}
bibliography: references.bib
---

```{r setup, include=FALSE, cache = FALSE}
library(tidyverse)
library(chrisplot) # `remotes::install_github("drcaprosser/chrisplot")`
library(sysfonts) 
library(showtext)
library(knitr)
library(kableExtra)
library(modelsummary)

# Create a bib file if there isn't one
if (!file.exists("references.bib")) {
  writeLines(c(
    "@article{example2025,",
    "  title   = {An example reference},",
    "  author  = {Doe, Jane},",
    "  journal = {Journal of Examples},",
    "  year    = {2025},",
    "  volume  = {1},",
    "  number  = {1},",
    "  pages   = {1--10},",
    "}"
  ), "references.bib", useBytes = TRUE)
}

# Various shenanigans to get figures to scale correctly with different page size and margins. 
paper_width_in <- function(paper) {
  switch(tolower(paper),
    "a4" = 8.27, "a4paper" = 8.27,
    "letter" = 8.5, "letterpaper" = 8.5,
    8.27  # default A4
  )
}

paper_height_in <- function(paper) {
  switch(tolower(paper),
    "a4" = 11.7, "a4paper" = 11.7,
    "letter" = 11, "letterpaper" = 11,
    11.7  # default A4
  )
}


geom <- rmarkdown::metadata$geometry %||% character(0)
paper <- rmarkdown::metadata$papersize %||% rmarkdown::metadata$classoption %||% "a4paper"

marg_in <- 1
if (length(geom)) {
  m <- str_match(paste(geom, collapse = ","), "margin\\s*=\\s*([0-9.]+)\\s*(in|mm)")
  if (!is.na(m[1,1])) {
    val <- as.numeric(m[1,2]); unit <- m[1,3]
    marg_in <- if (unit == "mm") val / 25.4 else val
  }
}

text_width_in <- paper_width_in(paper) - 2*marg_in
if (!is.finite(text_width_in) || text_width_in <= 0) text_width_in <- 5.5  # fallback

text_height_in <- paper_height_in(paper) - 2*marg_in
if (!is.finite(text_height_in) || text_height_in <= 0) text_height_in <- 5.5  # fallback

# Set chunk options

knitr::opts_chunk$set(
  echo = FALSE, 
  message = FALSE, 
  warning = FALSE, 
  cache = TRUE, 
  dev       = "cairo_pdf",      
  fig.ext   = "pdf",
  fig.align = "center",
  fig.asp   = 1/see::golden_ratio(),  
  fig.width = text_width_in,                      
  out.width = "\\linewidth",    
  fig.pos = "H", out.extra = "")

# Modelsummary options
options(modelsummary_factory_latex = 'kableExtra')

# Set ggplot defaults

showtext_auto(enable = TRUE) 
theme_set(theme_academic()) 


```

